function t(t,e){const{global:n,lodash:i,DOM:o,JSON5:r,rid:u,Lock:a}=globalThis.ZY,l=t+"-tpl";return o.initTemplate(l,n.document,{html:e}),{name:t,template:"#"+l,props:{prop:String,label:String,type:String,formPath:String,parentModel:null,modelValue:null,part_key:String,context:null,selfpath:String,pathArr:Array,prop_config:Object,ui:{type:Object,default:()=>({})},rules:{type:Object,default:()=>({})},slotContent:null,formId:String},setup(t,{emit:e}){const{ref:o,watch:l,provide:c,onBeforeUnmount:p}=n.Vue,f=t.context,d="cm-field-"+u(),g=new a;let s=o("");function m(t){const e=document.createElement("div");return e.innerHTML=t,e.textContent}"checkbox"===t.type&&(s=o([])),"time"===t.type&&(s=o(new Date)),l((()=>t.modelValue),(function(t){t!==s.value&&(s.value=t)}),{immediate:!0});let h={};try{h=r.parse(r.stringify(f.get_SELF_CONFIG()))}catch(y){}if(t.ui.widget2)try{const e=function(t={}){return t}(r.parse(t.ui.widget2));t.ui=Object.assign(t.ui,e.data)}catch(y){}if(t.ui.widgetConfig&&t.ui.widgetExt)try{const e=r.parse(t.ui.widgetExt);t.ui.widgetConfig=Object.assign(t.ui.widgetConfig,e.data)}catch(y){}const C=t.ui?t.ui.widgetConfig:null;C&&C.common_state&&(C[C.common_state]=C.common_state);const b={onBlur:function(t){f.fireEvent("blur",t),f.fireEvent("cmfield:blur",t)},p_selfpath:t.selfpath,p_formpath:t.formPath,p_pathArr:t.pathArr,onInput:function(){g.isLocked||g.lock((()=>{e("update:modelValue",s.value)}),100)},getOpt:function(e,n){return i.get(t.ui,e,n)},getContextCONFIG:function(t){return t?i.get(h,t):h},propConfig:t.prop_config,getLabel:function(){return m(t.ui&&t.ui.label?t.ui.label:t.label)},showLabel:function(){return!t.ui||!t.ui.hiddenLabel},getDesc:function(){return m(t.ui&&t.ui.desc?t.ui.desc:"")},cachedConfig:h,getUIOpt:function(e,n){return i.get(t.ui,e,n)},widgetConfig2:C,onFchange:function(e){f&&f.forceUpdate&&f.forceUpdate(t.parentModel,t.prop,e)},isArray:function(t){return Array.isArray(t)},context:f,cmFieldUUID:d,getProp:function(t=[]){let e="";return t.forEach(((t,n)=>{e=n<1?t:"number"==typeof t?`${e}[${t}]`:`${e}.${t}`})),e},formSlotContent:t.slotContent,part_key:t.part_key,value:s,onChange:function(){e("update:modelValue",s.value)}};return c("CurCmField",b),n.cmFieldContext||(n.cmFieldContext=new Map),n.cmFieldContext.set(d,b),p((()=>{n.cmFieldContext.delete(d)})),b}}}export{t as default};
