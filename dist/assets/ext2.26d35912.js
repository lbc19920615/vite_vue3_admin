var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,s=(e,s)=>{for(var i in s||(s={}))o.call(s,i)&&l(e,i,s[i]);if(t)for(var i of t(s))n.call(s,i)&&l(e,i,s[i]);return e};import i from"./CodeMirror.080f6ca7.js";import{a2 as a,z as r,v as u,w as d}from"./index.23ee6f22.js";import{r as c,e as m,f as p,g as f,w as g,D as h,A as y,B as v,C,M as b,x as j,F as x,H as k,h as w,k as S,s as V,o as _,y as O}from"./vendor.70e2a6e0.js";import{f as A,g as Z}from"./ext.03204df0.js";import"http://192.168.1.67:7002/public/expose/main.js";import"http://192.168.1.67:7002/public/expose/ext.js";import"./CommonRender.d6009dc7.js";import"./nodes.a56b7126.js";import"./form.e330999e.js";const M={name:"ZEasyDialog",props:{title:{type:String,default:"打开"},modelAttr:{type:Object,default:()=>({})},buttonAttr:{type:Object,default:()=>({})}},data:()=>({opened:!1}),methods:{openModal(){this.opened=!this.opened},getStyle(){return this.opened?{height:"auto"}:{}}}},E={class:"z-easy-dialog"},z={class:"z-easy-dialog__content"};M.render=function(e,t,o,n,l,s){const i=c("el-button"),a=c("el-popover");return m(),p("section",E,[f(a,h({class:"z-easy-dialog__dialog"},o.modelAttr,{modelValue:l.opened,"onUpdate:modelValue":t[0]||(t[0]=e=>l.opened=e),placement:"top","popper-class":"z-easy-dialog__popover"}),{reference:g((()=>[f(i,h(o.buttonAttr,{onClick:s.openModal}),{default:g((()=>[y(v(o.title),1)])),_:1},16,["onClick"])])),default:g((()=>[C("div",z,[b(e.$slots,"default")])])),_:3},16,["modelValue"])])};const R={name:"CodeJsEditor",components:{ZEasyDialog:M},mixins:[a],emits:["update:value","init"],props:{modelValue:String,ui:null,editorRef:null},data(){let e=new ZY.Lock,t=ZY.lodash.get(this,"ui.widgetConfig.style");return{content:"",lock:e,inited:!1,mode:ZY.lodash.get(this,"ui.widgetConfig.mode","text/javascript"),styleObj:s({},t)}},watch:{modelValue:{handler(e){this.lock.isLocked||(this.content=e,this.$nextTick((()=>{this.inited?this.$refs.editorRef.setModel(e):this.inited=!0})))},immediate:!0}},methods:{editorChange:function(e){this.lock.lock((()=>{this.$emit("update:modelValue",e),this.$emit("fchange",e)}),1e3)}},setup(e,t){var o,n,l;let s=V(),[i,a]=r({timeout:500}),u=null!=(n=null==(o=null==e?void 0:e.ui)?void 0:o.widgetConfig)?n:{},d=null!=(l=Array.isArray(u.suggest))?l:[],c=j({column:[{prop:"label",width:"150px"},{prop:"value",label:"VALUE"}],visible:!1});function m(e){s.ctx.$refs.editorRef.insertText(e),setTimeout((()=>{s.ctx.$refs.editorRef.getValue(),c.visible=!1}),30)}return{state:c,onSelect:m,modelAttr:{width:"50%"},elements:function(){var e;return null!=(e=u.suggests)?e:[]},selectQuickElement:function(e={}){var t;m(null!=(t=e.value)?t:"")},getSuggest:function(){if(e.ui.widgetConfig.enums){return s.ctx.dxValueTemplate(e.ui.widgetConfig.enums)}return d||[]},refMan:i,setRefMan:a}}},$={class:"code-js-editor"},I=["onClick"];R.render=function(e,t,o,n,l,s){const i=c("el-col"),a=c("el-row"),r=c("z-easy-dialog"),u=c("el-space"),d=c("CodeMirror");return m(),p("div",$,[f(u,{class:"a-space-mb-10",align:"middle"},{default:g((()=>[f(r,{title:"快捷指令","button-attr":{size:"small"},"model-attr":n.modelAttr},{default:g((()=>[f(a,{style:{height:"350px"}},{default:g((()=>[f(i,{span:24},{default:g((()=>[f(a,null,{default:g((()=>[(m(!0),p(x,null,k(n.elements(),(e=>(m(),w(i,{class:"g-list-group-item",span:12},{default:g((()=>[C("div",{class:"g-list-group-item__element",onClick:t=>n.selectQuickElement(e)},v(e.label),9,I)])),_:2},1024)))),256))])),_:1})])),_:1})])),_:1})])),_:1},8,["model-attr"])])),_:1}),l.inited?(m(),w(d,{key:0,ref:"editorRef",modelValue:l.content,"onUpdate:modelValue":[t[0]||(t[0]=e=>l.content=e),s.editorChange],height:l.styleObj.height,mode:l.mode,theme:"vscode-dark"},null,8,["modelValue","onUpdate:modelValue","height","mode"])):S("",!0)])};const Y={name:"CusStyle",components:{ZStyles:A,EwSuggest:Z},mixins:[u],setup(e,t){var o,n;let l,s=null!=(n=null==(o=null==e?void 0:e.ui)?void 0:o.widgetConfig)?n:{},i=ZY.JSON5,{data:a,methods:r,listeners:u,init:c}=d(e,t,{handleValueInit(e,t){if(console.log("CusStyle",e,typeof e),e)try{l=i.parse(e),m.control=l}catch(o){}else m.control.styles=[];return{}}}),m=a({value:{},control:{},chushi:!1});function p(){let e=i.parse(i.stringify(m.value)),t=i.stringify(e);r.on_change(t)}let f=null;return _((()=>{s.mounted&&c(e)})),O((()=>e.modelValue),(e=>{}),{}),{state:m,widgetConfig:s,onChange:p,methods:r,onStylesInited:function({initData:e}){f=e},onStylesChange:function(e){m.value.styles=ZY.JSON5.parse(ZY.JSON5.stringify(e)),p()},onBlur:function(){p()},save:function(){p()},listeners:u}}},P={key:0,class:"a-space-mb-10"};function D(){CustomVueComponent.registerOnce(Y),CustomVueComponent.registerOnce(i,"CodeMirror"),CustomVueComponent.registerOnce(R)}Y.render=function(e,t,o,n,l,s){const i=c("ZStyles");return e.inited?(m(),p(x,{key:0},[n.state.control?(m(),p("section",P,[f(i,{style:{flex:"1"},onInited:n.onStylesInited,value:n.state.control.styles,"onForm:input:blur":n.onBlur,onPropsChange:n.onStylesChange},null,8,["onInited","value","onForm:input:blur","onPropsChange"])])):S("",!0)],64)):S("",!0)};export{D as registerExt2};
